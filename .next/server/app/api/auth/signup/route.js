(()=>{var e={};e.id=8887,e.ids=[8887],e.modules={1678:(e,r,t)=>{"use strict";t.d(r,{db:()=>i});let s=require("@prisma/client"),i=global.prisma||new s.PrismaClient({log:["query"]})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8054:(e,r,t)=>{"use strict";t.d(r,{A$:()=>c,J1:()=>p,kH:()=>u,xw:()=>d});var s=t(49526),i=t(1678),a=t(55511);let n=s.createTransport({host:process.env.SMTP_HOST,port:Number(process.env.SMTP_PORT),secure:"true"===process.env.SMTP_SECURE,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASSWORD}});function o(){return(0,a.randomBytes)(32).toString("hex")}async function u(e,r){let t=o(),s=new Date(Date.now()+864e5);await i.db.verificationToken.create({data:{userId:e,token:t,expires:s}});let a=`${process.env.NEXTAUTH_URL}/auth/verify?token=${t}`;await n.sendMail({from:process.env.SMTP_FROM,to:r,subject:"Verify your email address",html:`
      <h1>Email Verification</h1>
      <p>Click the link below to verify your email address:</p>
      <a href="${a}">${a}</a>
      <p>This link will expire in 24 hours.</p>
    `})}async function p(e){let r=await i.db.user.findUnique({where:{email:e}});if(!r)return;let t=o(),s=new Date(Date.now()+36e5);await i.db.resetToken.create({data:{userId:r.id,token:t,expires:s}});let a=`${process.env.NEXTAUTH_URL}/auth/reset-password?token=${t}`;await n.sendMail({from:process.env.SMTP_FROM,to:e,subject:"Reset your password",html:`
      <h1>Password Reset</h1>
      <p>Click the link below to reset your password:</p>
      <a href="${a}">${a}</a>
      <p>This link will expire in 1 hour.</p>
      <p>If you didn't request this, please ignore this email.</p>
    `})}async function d(e,r){let t=await i.db.resetToken.findUnique({where:{token:e},include:{user:!0}});if(!t||t.expires<new Date)throw Error("Invalid or expired reset token");let s=await bcrypt.hash(r,10);await i.db.$transaction([i.db.user.update({where:{id:t.userId},data:{password:s}}),i.db.resetToken.delete({where:{id:t.id}})])}async function c(e){let r=await i.db.verificationToken.findUnique({where:{token:e},include:{user:!0}});if(!r||r.expires<new Date)throw Error("Invalid or expired verification token");await i.db.$transaction([i.db.user.update({where:{id:r.userId},data:{emailVerified:new Date}}),i.db.verificationToken.delete({where:{id:r.id}})])}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},41666:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>l,serverHooks:()=>x,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{POST:()=>c});var i=t(96559),a=t(48088),n=t(37719),o=t(32190),u=t(85663),p=t(1678),d=t(8054);async function c(e){try{let{name:r,email:t,password:s}=await e.json();if(!r||!t||!s)return new o.NextResponse("Missing required fields",{status:400});if(await p.db.user.findUnique({where:{email:t}}))return new o.NextResponse("User already exists",{status:400});let i=await (0,u.tW)(s,10),a=await p.db.user.create({data:{name:r,email:t,password:i}});try{await (0,d.kH)(a.id,a.email)}catch(e){console.error("Failed to send verification email:",e)}return o.NextResponse.json({message:"User created successfully",user:{id:a.id,name:a.name,email:a.email}})}catch(e){return console.error("Signup error:",e),new o.NextResponse("Internal error",{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"C:\\Users\\Awais\\Downloads\\workspace-af655d45-ec8c-4874-bfd0-23615092e71d (3)\\src\\app\\api\\auth\\signup\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:h,serverHooks:x}=l;function f(){return(0,n.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:h})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719,580,5663,9526],()=>t(41666));module.exports=s})();